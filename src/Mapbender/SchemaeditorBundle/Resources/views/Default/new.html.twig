{% extends "FOMManagerBundle::manager.html.twig" %}

{% block title %}{{ 'New Feature' | trans }}{% endblock %}

{% block manager_content %}

{# 
    @todo: Ask Vadim for serviceAddBox
#}
<fieldset class="left box serviceAddBox" style="width:100%">
    <legend>Schema</legend>
    <form action="{{ path("mapbender_schemaeditor_default_create") }}" method="post">

{% if columns is not defined or columns is null %}
        <label class="left labelInput">Example:</label>
        <div class="inputWrapper">
            <i>posgresql://user:password@host:port/dbname</i>
        </div>
        <div class="clearContainer"></div>
        <label for="schemaeditor_url" class="left labelInput">URL:</label>
        <div class="inputWrapper">
            <input type="text" id="schemaeditor_url" class="input validationInput" name="schemaeditor[url]" value="{% if url is defined %}{{ url }}{% endif %}" />
        </div>

{% if tables is defined and tables is not null %}
        <label for="schemaeditor_table" class="left labelInput">Table:</label>
        <div class="inputWrapper">
            {# 
                @todo: Ask Vadim for nice select box
            #}
            <select name="schemaeditor[table]" id="schemaeditor_table">
                <option value=""></option>
{% for table in tables %}
                <option value="{{ table }}">{{ table }}</option>
{% endfor %}
            </select>
        </div>
{% endif %}

<div class="clearContainer"></div>
{% endif %}
{% if columns is defined and columns is not null %}
        <label for="schemaeditor_description" class="left labelInput">Description:</label>
        <div class="inputWrapper">
            <input type="text" name="schemaeditor[description]" id="schemaeditor_description" value="{% if description is defined and description is not null %}{{ description }}{% endif %}" />
        </div>

        <label for="schemaeditor_yml" class="left labelInput">YAML:</label>
        <div class="inputWrapper">
            <textarea class="input code-yaml" style="height:100px;" name="schemaeditor[yml]" id="schemaeditor_yml">{% if yml is defined and yml is not null %}{{ yml }}{% endif %}</textarea>
        </div>

        <div class="clearContainer"></div>

        <label for="schemaeditor_column" class="left labelInput">Column:</label>
        <div class="inputWrapper">
            <textarea class="input" style="height:100px;width:100%" name="schemaeditor[column]" id="schemaeditor_column">{{ columns }}</textarea>
{#                                    ^
    @todo: Vadim lure ma he -----------
#}
        </div>

{% endif %}

        <div class="clearContainer"></div>
        <div class="clearContainer"></div>
        <br/>
        <div class="right">
            <input class="button" type="submit" name="load" value="Load" />
            <a href="{{ path("mapbender_schemaeditor_default_index") }}" class="button critical">Cancel</a>
        </div>
    </form>
</fieldset>
<link rel="stylesheet" href="{{ asset('bundles/mapbendermanager/codemirror2/lib/codemirror.css') }}">

<div class="clearContainer"></div>
{% endblock %}

{% block js %}
    {{ parent() }}
    <script src="{{ asset('bundles/mapbendermanager/codemirror2/lib/codemirror.js') }}"></script>
    <script src="{{ asset('bundles/mapbendermanager/codemirror2/mode/yaml/yaml.js') }}"></script>
    <script src="{{ asset('bundles/mapbendermanager/js/form-yaml.js') }}"></script>
{% endblock %}